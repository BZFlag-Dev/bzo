<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Battlezone Online</title>
  <link rel="icon" type="image/svg+xml" href="favicon.svg">
  <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div id="operatorOverlay" class="dialog" style="display:none">
      <div class="dialogTitle">Operator Panel <button id="closeOperatorBtn" class="closeBtn">&times;</button></div>
      <div class="dialogContent">
        <div id="motd" style="margin-bottom: 10px; font-size: 1.1em; color: #4CAF50;">MOTD: </div>
        <div style="margin-bottom: 10px;">
          <label for="mapList">Map:</label>
          <select id="mapList"></select>
          <button id="restartBtn">Restart with Map</button>
        </div>
        <div style="margin-bottom: 10px;">
          <label for="uploadMap">Upload Map:</label>
          <input type="file" id="uploadMap" accept=".bzw,.txt">
          <button id="uploadBtn">Upload</button>
        </div>
      </div>
    </div>
  <!-- Mobile Controls Overlay (only visible on mobile) -->
  <!-- (Moved to end of body for z-index/DOM order reasons) -->
  <div id="mainhud">
    <div id="stats" style="display: flex; align-items: center; gap: 12px;">
      <span id="playerName" style="cursor: pointer; color: #4CAF50; font-weight: bold; font-size: 20px;" title="Click to change name">Player</span>
      <div id="hudButtons" style="display: inline-flex; gap: 6px; margin-left: 8px;">
        <button id="fullscreenBtn" title="Toggle Fullscreen (F)">F</button>
        <button id="debugBtn" title="Toggle Debug HUD (I)">I</button>
        <button id="mouseBtn" title="Toggle Mouse Movement (M)">M</button>
        <button id="cameraBtn" title="Toggle Camera View (C)">C</button>
        <button id="helpBtn" title="Show Help (?)">?</button>
        <button id="operatorBtn" title="Operator Panel (O)">O</button>
      </div>
    </div>
    <div id="scoreboard">
      <div id="scoreboardHeader">
        <span class="scoreboardName">Player</span>
        <span class="scoreboardStats">Kills / Deaths</span>
      </div>
      <div id="scoreboardList"></div>
    </div>
  </div>

  <div id="chatWindow">
    <div id="chatMessages"></div>
    <div class="chat-input-row">
      <select id="chatTarget">
        <option value="0">ALL</option>
        <option value="-1">SERVER</option>
      </select>
      <input id="chatInput" type="text" />
    </div>
  </div>

  <div id="debugHud" style="display: none;">
    <h3>Debug Info</h3>
    <div id="debugContent"></div>
  </div>

  <div id="entryDialog" style="display: none;">
    <h2>Battlezone Online</h2>
    <div id="serverInfo" style="margin-bottom: 10px; font-size: 1.1em; color: #333;">
      <span id="serverName">Server:</span><br>
      <span id="serverDescription"></span><br>
      <span id="serverMotd" style="color: #4CAF50;"></span>
    </div>
    <input type="text" id="entryInput" maxlength="20" placeholder="Enter your name">
    <div class="entryDialogButtons">
      <button id="nameOkButton">OK</button>
      <button id="nameDefaultButton">Default</button>
      <button id="nameCancelButton">Cancel</button>
    </div>
  </div>

  <div id="helpPanel" style="display: none;">
    <h1>Battlezone Online</h1>
    <div id="helpContent">
      <h2>HUD Buttons</h2>
      <ul>
        <li><strong>F</strong> — <b>Fullscreen</b> (or click <b>F</b> button)</li>
        <li><strong>I</strong> — <b>Debug HUD</b> (or click <b>I</b> button)</li>
        <li><strong>M</strong> — <b>Mouse Movement</b> (or click <b>M</b> button)</li>
        <li><strong>C</strong> — <b>Camera View</b> (or click <b>C</b> button)</li>
        <li><strong>O</strong> — <b>Operator Panel</b> (or click <b>O</b> button)</li>
        <li><strong>?</strong> — <b>Show/Hide Help</b> (or click <b>?</b> button)</li>
      </ul>

      <h2>Movement & Actions</h2>
      <ul>
        <li><strong>W/S</strong> — Move Forward/Backward</li>
        <li><strong>A/D</strong> — Turn Left/Right</li>
        <li><strong>Space</strong> — Shoot</li>
        <li><strong>Tab</strong> — Jump</li>
        <li><strong>C</strong> — Toggle Camera View</li>
        <li><strong>P</strong> — Pause Game</li>
        <li><strong>O</strong> — Operator Panel</li>
      </ul>

      <h2>Mobile On-Screen Controls</h2>
      <ul>
        <li><strong>⤒</strong> — Jump (tap button)</li>
        <li><strong>●</strong> — Fire (tap button)</li>
        <li>Use on-screen joystick to move/turn</li>
      </ul>

      <h2>Mouse Mode</h2>
      <ul>
        <li><strong>M</strong> or <b>M</b> button — Enable/Disable Mouse Movement</li>
        <li><strong>ESC</strong> — Exit Mouse Mode (return to keyboard)</li>
        <li><strong>Mouse Up/Down</strong> — Control Speed</li>
        <li><strong>Mouse Left/Right</strong> — Turn Tank</li>
        <li><strong>Left Click</strong> — Shoot</li>
      </ul>

      <h2>Chat & Misc</h2>
      <ul>
        <li><strong>/</strong> or <strong>T</strong> — Open Chat</li>
        <li><strong>Enter</strong> — Send Chat</li>
        <li><strong>Click Player Name</strong> — Change Name</li>
      </ul>
    </div>
  </div>

  <div id="controlBox"></div>
  <div id="crosshair">
    <div class="center"></div>
  </div>
  <canvas id="radar"></canvas>

  <script type="importmap">
    {
      "imports": {
        "three": "https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.module.js",
        "three/addons/": "https://cdn.jsdelivr.net/npm/three@0.160.0/examples/jsm/"
      }
    }
  </script>
  <script type="module" src="game.js"></script>
  </script>
</body>
<!-- Mobile Controls Overlay (only visible on mobile) -->
<div id="controlsOverlay" style="display:none;">
  <div class="mobile-joystick" id="joystick">
    <div class="joystick-knob" id="joystickKnob"></div>
  </div>
  <button class="mobile-btn" id="jumpBtn">⤒</button>
  <button class="mobile-btn" id="fireBtn">●</button>
</div>
</html>
